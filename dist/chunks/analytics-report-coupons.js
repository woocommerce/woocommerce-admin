(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[8],{508:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o(1),c=o.n(r),a=o(2),i=o(561),s=o(5),u=o(22),m=o(13),d=o(122),l=o(21),p=o(533),b=o(527),_=o(23);class y extends n.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:Object(a.__)("Coupon code","woocommerce-admin"),key:"code",required:!0,isLeftAligned:!0,isSortable:!0},{label:Object(a.__)("Orders","woocommerce-admin"),key:"orders_count",required:!0,defaultSort:!0,isSortable:!0,isNumeric:!0},{label:Object(a.__)("Amount discounted","woocommerce-admin"),key:"amount",isSortable:!0,isNumeric:!0},{label:Object(a.__)("Created","woocommerce-admin"),key:"created"},{label:Object(a.__)("Expires","woocommerce-admin"),key:"expires"},{label:Object(a.__)("Type","woocommerce-admin"),key:"type"}]}getRowsContent(e){const{query:t}=this.props,o=Object(m.getPersistedQuery)(t),r=Object(_.d)("dateFormat",l.defaultTableDateFormat),{formatAmount:c,formatDecimal:i,getCurrencyConfig:p}=this.context;return Object(s.map)(e,e=>{const{amount:t,coupon_id:s,orders_count:l}=e,b=e.extended_info||{},{code:_,date_created:y,date_expires:f,discount_type:h}=b,j=s>0?Object(m.getNewPath)(o,"/analytics/coupons",{filter:"single_coupon",coupons:s}):null,O=null===j?_:Object(n.createElement)(u.Link,{href:j,type:"wc-admin"},_),g=s>0?Object(m.getNewPath)(o,"/analytics/orders",{filter:"advanced",coupon_includes:s}):null;return[{display:O,value:_},{display:null===g?l:Object(n.createElement)(u.Link,{href:g,type:"wc-admin"},Object(d.formatValue)(p(),"number",l)),value:l},{display:c(t),value:i(t)},{display:y?Object(n.createElement)(u.Date,{date:y,visibleFormat:r}):Object(a.__)("N/A","woocommerce-admin"),value:y},{display:f?Object(n.createElement)(u.Date,{date:f,visibleFormat:r}):Object(a.__)("N/A","woocommerce-admin"),value:f},{display:this.getCouponType(h),value:h}]})}getSummary(e){const{coupons_count:t=0,orders_count:o=0,amount:n=0}=e,{formatAmount:r,getCurrencyConfig:c}=this.context,i=c();return[{label:Object(a._n)("Coupon","Coupons",t,"woocommerce-admin"),value:Object(d.formatValue)(i,"number",t)},{label:Object(a._n)("Order","Orders",o,"woocommerce-admin"),value:Object(d.formatValue)(i,"number",o)},{label:Object(a.__)("Amount discounted","woocommerce-admin"),value:r(n)}]}getCouponType(e){return{percent:Object(a.__)("Percentage","woocommerce-admin"),fixed_cart:Object(a.__)("Fixed cart","woocommerce-admin"),fixed_product:Object(a.__)("Fixed product","woocommerce-admin")}[e]||Object(a.__)("N/A","woocommerce-admin")}render(){const{advancedFilters:e,filters:t,isRequesting:o,query:r}=this.props;return Object(n.createElement)(p.a,{compareBy:"coupons",endpoint:"coupons",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["coupons_count","orders_count","amount"],isRequesting:o,itemIdField:"coupon_id",query:r,searchBy:"coupons",tableQuery:{orderby:r.orderby||"orders_count",order:r.order||"desc",extended_info:!0},title:Object(a.__)("Coupons","woocommerce-admin"),columnPrefsKey:"coupons_report_columns",filters:t,advancedFilters:e})}}y.contextType=b.a;var f=y,h=o(536),j=o(534),O=o(537),g=o(532);class w extends n.Component{getChartMeta(){const{query:e}=this.props,t="compare-coupons"===e.filter&&e.coupons&&e.coupons.split(",").length>1?"item-comparison":"time-comparison";return{itemsLabel:Object(a.__)("%d coupons","woocommerce-admin"),mode:t}}render(){const{isRequesting:e,query:t,path:o}=this.props,{mode:r,itemsLabel:c}=this.getChartMeta(),a={...t};return"item-comparison"===r&&(a.segmentby="coupon"),Object(n.createElement)(n.Fragment,null,Object(n.createElement)(g.a,{query:t,path:o,filters:i.c,advancedFilters:i.a,report:"coupons"}),Object(n.createElement)(O.a,{charts:i.b,endpoint:"coupons",isRequesting:e,query:a,selectedChart:Object(h.a)(t.chart,i.b),filters:i.c,advancedFilters:i.a}),Object(n.createElement)(j.a,{charts:i.b,filters:i.c,advancedFilters:i.a,mode:r,endpoint:"coupons",path:o,query:a,isRequesting:e,itemsLabel:c,selectedChart:Object(h.a)(t.chart,i.b)}),Object(n.createElement)(f,{isRequesting:e,query:t,filters:i.c,advancedFilters:i.a}))}}w.propTypes={query:c.a.object.isRequired};t.default=w},528:function(e,t,o){"use strict";o.d(t,"e",(function(){return d})),o.d(t,"a",(function(){return l})),o.d(t,"b",(function(){return p})),o.d(t,"c",(function(){return b})),o.d(t,"d",(function(){return _})),o.d(t,"f",(function(){return y})),o.d(t,"h",(function(){return f})),o.d(t,"g",(function(){return h}));var n=o(16),r=o(19),c=o.n(r),a=o(5),i=o(13),s=o(12),u=o(529),m=o(23);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.identity;return function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0;const a="function"==typeof e?e(r):e,s=Object(i.getIdsFromQuery)(o);if(s.length<1)return Promise.resolve([]);const u={include:s.join(","),per_page:s.length};return c()({path:Object(n.addQueryArgs)(a,u)}).then(e=>e.map(t))}}d(s.NAMESPACE+"/products/attributes",e=>({key:e.id,label:e.name}));const l=d(s.NAMESPACE+"/products/categories",e=>({key:e.id,label:e.name})),p=d(s.NAMESPACE+"/coupons",e=>({key:e.id,label:e.code})),b=d(s.NAMESPACE+"/customers",e=>({key:e.id,label:e.name})),_=d(s.NAMESPACE+"/products",e=>({key:e.id,label:e.name})),y=d(s.NAMESPACE+"/taxes",e=>({key:e.id,label:Object(u.a)(e)}));function f(e){let{attributes:t,name:o}=e;const n=Object(m.d)("variationTitleAttributesSeparator"," - ");if(o&&o.indexOf(n)>-1)return o;const r=(t||[]).map(e=>{let{option:t}=e;return t}).join(", ");return r?o+n+r:o}const h=d(e=>{let{products:t}=e;return t?s.NAMESPACE+`/products/${t}/variations`:s.NAMESPACE+"/variations"},e=>({key:e.id,label:f(e)}))},529:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(2);function r(e){return[e.country,e.state,e.name||Object(n.__)("TAX","woocommerce-admin"),e.priority].map(e=>e.toString().toUpperCase().trim()).filter(Boolean).join("-")}},561:function(e,t,o){"use strict";o.d(t,"b",(function(){return u})),o.d(t,"a",(function(){return m})),o.d(t,"c",(function(){return l}));var n=o(2),r=o(28),c=o(8),a=o(528),i=o(59);const{addCesSurveyForAnalytics:s}=Object(c.dispatch)(i.c),u=Object(r.applyFilters)("woocommerce_admin_coupons_report_charts",[{key:"orders_count",label:Object(n.__)("Discounted orders","woocommerce-admin"),order:"desc",orderby:"orders_count",type:"number"},{key:"amount",label:Object(n.__)("Amount","woocommerce-admin"),order:"desc",orderby:"amount",type:"currency"}]),m=Object(r.applyFilters)("woocommerce_admin_coupon_report_advanced_filters",{filters:{},title:Object(n._x)("Coupons match {{select /}} filters","A sentence describing filters for Coupons. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","woocommerce-admin")}),d=[{label:Object(n.__)("All coupons","woocommerce-admin"),value:"all"},{label:Object(n.__)("Single coupon","woocommerce-admin"),value:"select_coupon",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single_coupon",chartMode:"item-comparison",path:["select_coupon"],settings:{type:"coupons",param:"coupons",getLabels:a.b,labels:{placeholder:Object(n.__)("Type to search for a coupon","woocommerce-admin"),button:Object(n.__)("Single Coupon","woocommerce-admin")}}}]},{label:Object(n.__)("Comparison","woocommerce-admin"),value:"compare-coupons",settings:{type:"coupons",param:"coupons",getLabels:a.b,labels:{title:Object(n.__)("Compare Coupon Codes","woocommerce-admin"),update:Object(n.__)("Compare","woocommerce-admin"),helpText:Object(n.__)("Check at least two coupon codes below to compare","woocommerce-admin")},onClick:s}}];Object.keys(m.filters).length&&d.push({label:Object(n.__)("Advanced filters","woocommerce-admin"),value:"advanced"});const l=Object(r.applyFilters)("woocommerce_admin_coupons_report_filters",[{label:Object(n.__)("Show","woocommerce-admin"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:d}])}}]);