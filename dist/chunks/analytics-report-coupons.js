(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[8],{527:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o(1),c=o.n(r),a=o(2),i=o(579),s=o(3),u=o(23),m=o(12),d=o(139),l=o(17),p=o(21),b=o(550),_=o(545);class y extends n.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:Object(a.__)("Coupon Code","woocommerce-admin"),key:"code",required:!0,isLeftAligned:!0,isSortable:!0},{label:Object(a.__)("Orders","woocommerce-admin"),key:"orders_count",required:!0,defaultSort:!0,isSortable:!0,isNumeric:!0},{label:Object(a.__)("Amount Discounted","woocommerce-admin"),key:"amount",isSortable:!0,isNumeric:!0},{label:Object(a.__)("Created","woocommerce-admin"),key:"created"},{label:Object(a.__)("Expires","woocommerce-admin"),key:"expires"},{label:Object(a.__)("Type","woocommerce-admin"),key:"type"}]}getRowsContent(e){const{query:t}=this.props,o=Object(m.getPersistedQuery)(t),r=Object(l.h)("dateFormat",p.defaultTableDateFormat),{formatAmount:c,formatDecimal:i,getCurrencyConfig:b}=this.context;return Object(s.map)(e,e=>{const{amount:t,coupon_id:s,orders_count:l}=e,p=e.extended_info||{},{code:_,date_created:y,date_expires:j,discount_type:f}=p,O=s>0?Object(m.getNewPath)(o,"/analytics/coupons",{filter:"single_coupon",coupons:s}):null,h=null===O?_:Object(n.createElement)(u.Link,{href:O,type:"wc-admin"},_),g=s>0?Object(m.getNewPath)(o,"/analytics/orders",{filter:"advanced",coupon_includes:s}):null;return[{display:h,value:_},{display:null===g?l:Object(n.createElement)(u.Link,{href:g,type:"wc-admin"},Object(d.formatValue)(b(),"number",l)),value:l},{display:c(t),value:i(t)},{display:y?Object(n.createElement)(u.Date,{date:y,visibleFormat:r}):Object(a.__)("N/A","woocommerce-admin"),value:y},{display:j?Object(n.createElement)(u.Date,{date:j,visibleFormat:r}):Object(a.__)("N/A","woocommerce-admin"),value:j},{display:this.getCouponType(f),value:f}]})}getSummary(e){const{coupons_count:t=0,orders_count:o=0,amount:n=0}=e,{formatAmount:r,getCurrencyConfig:c}=this.context,i=c();return[{label:Object(a._n)("coupon","coupons",t,"woocommerce-admin"),value:Object(d.formatValue)(i,"number",t)},{label:Object(a._n)("order","orders",o,"woocommerce-admin"),value:Object(d.formatValue)(i,"number",o)},{label:Object(a.__)("amount discounted","woocommerce-admin"),value:r(n)}]}getCouponType(e){return{percent:Object(a.__)("Percentage","woocommerce-admin"),fixed_cart:Object(a.__)("Fixed cart","woocommerce-admin"),fixed_product:Object(a.__)("Fixed product","woocommerce-admin")}[e]||Object(a.__)("N/A","woocommerce-admin")}render(){const{advancedFilters:e,filters:t,isRequesting:o,query:r}=this.props;return Object(n.createElement)(b.a,{compareBy:"coupons",endpoint:"coupons",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["coupons_count","orders_count","amount"],isRequesting:o,itemIdField:"coupon_id",query:r,searchBy:"coupons",tableQuery:{orderby:r.orderby||"orders_count",order:r.order||"desc",extended_info:!0},title:Object(a.__)("Coupons","woocommerce-admin"),columnPrefsKey:"coupons_report_columns",filters:t,advancedFilters:e})}}y.contextType=_.a;var j=y,f=o(555),O=o(552),h=o(556),g=o(549);class w extends n.Component{getChartMeta(){const{query:e}=this.props,t="compare-coupons"===e.filter&&e.coupons&&e.coupons.split(",").length>1?"item-comparison":"time-comparison";return{itemsLabel:Object(a.__)("%d coupons","woocommerce-admin"),mode:t}}render(){const{isRequesting:e,query:t,path:o}=this.props,{mode:r,itemsLabel:c}=this.getChartMeta(),a={...t};return"item-comparison"===r&&(a.segmentby="coupon"),Object(n.createElement)(n.Fragment,null,Object(n.createElement)(g.a,{query:t,path:o,filters:i.c,advancedFilters:i.a,report:"coupons"}),Object(n.createElement)(h.a,{charts:i.b,endpoint:"coupons",isRequesting:e,query:a,selectedChart:Object(f.a)(t.chart,i.b),filters:i.c,advancedFilters:i.a}),Object(n.createElement)(O.a,{charts:i.b,filters:i.c,advancedFilters:i.a,mode:r,endpoint:"coupons",path:o,query:a,isRequesting:e,itemsLabel:c,selectedChart:Object(f.a)(t.chart,i.b)}),Object(n.createElement)(j,{isRequesting:e,query:t,filters:i.c,advancedFilters:i.a}))}}w.propTypes={query:c.a.object.isRequired};t.default=w},546:function(e,t,o){"use strict";o.d(t,"e",(function(){return d})),o.d(t,"a",(function(){return l})),o.d(t,"b",(function(){return p})),o.d(t,"c",(function(){return b})),o.d(t,"d",(function(){return _})),o.d(t,"f",(function(){return y})),o.d(t,"h",(function(){return j})),o.d(t,"g",(function(){return f}));var n=o(16),r=o(20),c=o.n(r),a=o(3),i=o(12),s=o(11),u=o(17),m=o(547);function d(e,t=a.identity){return function(o="",r){const a="function"==typeof e?e(r):e,s=Object(i.getIdsFromQuery)(o);if(s.length<1)return Promise.resolve([]);const u={include:s.join(","),per_page:s.length};return c()({path:Object(n.addQueryArgs)(a,u)}).then(e=>e.map(t))}}d(s.NAMESPACE+"/products/attributes",e=>({key:e.id,label:e.name}));const l=d(s.NAMESPACE+"/products/categories",e=>({key:e.id,label:e.name})),p=d(s.NAMESPACE+"/coupons",e=>({key:e.id,label:e.code})),b=d(s.NAMESPACE+"/customers",e=>({key:e.id,label:e.name})),_=d(s.NAMESPACE+"/products",e=>({key:e.id,label:e.name})),y=d(s.NAMESPACE+"/taxes",e=>({key:e.id,label:Object(m.a)(e)}));function j({attributes:e,name:t}){const o=Object(u.h)("variationTitleAttributesSeparator"," - ");if(t.indexOf(o)>-1)return t;const n=e.map(({option:e})=>e).join(", ");return n?t+o+n:t}const f=d(({products:e})=>e?s.NAMESPACE+`/products/${e}/variations`:s.NAMESPACE+"/variations",e=>({key:e.id,label:j(e)}))},547:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(2);function r(e){return[e.country,e.state,e.name||Object(n.__)("TAX","woocommerce-admin"),e.priority].map(e=>e.toString().toUpperCase().trim()).filter(Boolean).join("-")}},579:function(e,t,o){"use strict";o.d(t,"b",(function(){return u})),o.d(t,"c",(function(){return m})),o.d(t,"a",(function(){return d}));var n=o(2),r=o(34),c=o(7),a=o(546),i=o(62);const{addCesSurveyForAnalytics:s}=Object(c.dispatch)(i.c),u=Object(r.applyFilters)("woocommerce_admin_coupons_report_charts",[{key:"orders_count",label:Object(n.__)("Discounted Orders","woocommerce-admin"),order:"desc",orderby:"orders_count",type:"number"},{key:"amount",label:Object(n.__)("Amount","woocommerce-admin"),order:"desc",orderby:"amount",type:"currency"}]),m=Object(r.applyFilters)("woocommerce_admin_coupons_report_filters",[{label:Object(n.__)("Show","woocommerce-admin"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:[{label:Object(n.__)("All Coupons","woocommerce-admin"),value:"all"},{label:Object(n.__)("Single Coupon","woocommerce-admin"),value:"select_coupon",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single_coupon",chartMode:"item-comparison",path:["select_coupon"],settings:{type:"coupons",param:"coupons",getLabels:a.b,labels:{placeholder:Object(n.__)("Type to search for a coupon","woocommerce-admin"),button:Object(n.__)("Single Coupon","woocommerce-admin")}}}]},{label:Object(n.__)("Comparison","woocommerce-admin"),value:"compare-coupons",settings:{type:"coupons",param:"coupons",getLabels:a.b,labels:{title:Object(n.__)("Compare Coupon Codes","woocommerce-admin"),update:Object(n.__)("Compare","woocommerce-admin"),helpText:Object(n.__)("Check at least two coupon codes below to compare","woocommerce-admin")},onClick:s}}]}]),d=Object(r.applyFilters)("woocommerce_admin_coupon_report_advanced_filters",{})}}]);