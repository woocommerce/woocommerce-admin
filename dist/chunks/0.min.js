(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[0],{527:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var a=r(0),n=r(28),s=r(91),o=r.n(s),i=r(23);const c=o()(i.a),l=e=>{const t=c.getCurrencyConfig(),r=Object(n.applyFilters)("woocommerce_admin_report_currency",t,e);return o()(r)},d=Object(a.createContext)(c)},530:function(e,t,r){"use strict";var a=r(0),n=r(2),s=r(1),o=r.n(s),i=r(22);function c(e){let{className:t}=e;const r=Object(n.__)("There was an error getting your stats. Please try again.","woocommerce-admin"),s=Object(n.__)("Reload","woocommerce-admin");return Object(a.createElement)(i.EmptyContent,{className:t,title:r,actionLabel:s,actionCallback:()=>{window.location.reload()}})}c.propTypes={className:o.a.string},t.a=c},532:function(e,t,r){"use strict";var a=r(0),n=r(14),s=r(1),o=r.n(s),i=r(5),c=r(8),l=r(22),d=r(12),m=r(21),u=r(17),p=r(527),b=r(59),y=r(23);class g extends a.Component{constructor(){super(),this.onDateSelect=this.onDateSelect.bind(this),this.onFilterSelect=this.onFilterSelect.bind(this),this.onAdvancedFilterAction=this.onAdvancedFilterAction.bind(this)}onDateSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props;r(),Object(u.recordEvent)("datepicker_update",{report:t,...Object(i.omitBy)(e,i.isUndefined)})}onFilterSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props,a=e.filter||e["filter-variations"];["single_product","single_category","single_coupon","single_variation"].includes(a)&&r();const n={report:t,filter:e.filter||"all"};"single_product"===e.filter&&(n.filter_variation=e["filter-variations"]||"all"),Object(u.recordEvent)("analytics_filter",n)}onAdvancedFilterAction(e,t){const{report:r,addCesSurveyForAnalytics:a}=this.props;switch(e){case"add":Object(u.recordEvent)("analytics_filters_add",{report:r,filter:t.key});break;case"remove":Object(u.recordEvent)("analytics_filters_remove",{report:r,filter:t.key});break;case"filter":const e=Object.keys(t).reduce((e,r)=>(e[Object(i.snakeCase)(r)]=t[r],e),{});a(),Object(u.recordEvent)("analytics_filters_filter",{report:r,...e});break;case"clear_all":Object(u.recordEvent)("analytics_filters_clear_all",{report:r});break;case"match":Object(u.recordEvent)("analytics_filters_all_any",{report:r,value:t.match})}}render(){const{advancedFilters:e,filters:t,path:r,query:n,showDatePicker:s,defaultDateRange:o}=this.props,{period:i,compare:c,before:d,after:u}=Object(m.getDateParamsFromQuery)(n,o),{primary:p,secondary:b}=Object(m.getCurrentDates)(n,o),g={period:i,compare:c,before:d,after:u,primaryDate:p,secondaryDate:b},h=this.context;return Object(a.createElement)(l.ReportFilters,{query:n,siteLocale:y.b.siteLocale,currency:h.getCurrencyConfig(),path:r,filters:t,advancedFilters:e,showDatePicker:s,onDateSelect:this.onDateSelect,onFilterSelect:this.onFilterSelect,onAdvancedFilterAction:this.onAdvancedFilterAction,dateQuery:g,isoDateFormat:m.isoDateFormat})}}g.contextType=p.a,t.a=Object(n.compose)(Object(c.withSelect)(e=>{const{woocommerce_default_date_range:t}=e(d.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{defaultDateRange:t}}),Object(c.withDispatch)(e=>{const{addCesSurveyForAnalytics:t}=e(b.c);return{addCesSurveyForAnalytics:t}}))(g),g.propTypes={advancedFilters:o.a.object,filters:o.a.array,path:o.a.string.isRequired,query:o.a.object,showDatePicker:o.a.bool,report:o.a.string.isRequired}},533:function(e,t,r){"use strict";var a=r(40),n=r.n(a),s=r(0),o=r(4),i=r(28),c=r(14),l=r(93),d=r(8),m=r(5),u=r(2),p=r(1),b=r.n(p),y=r(22),g=r(13),h=r(497),f=r(12),_=r(17),O=()=>Object(s.createElement)("svg",{role:"img","aria-hidden":"true",focusable:"false",version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},Object(s.createElement)("path",{d:"M18,9c-0.009,0-0.017,0.002-0.025,0.003C17.72,5.646,14.922,3,11.5,3C7.91,3,5,5.91,5,9.5c0,0.524,0.069,1.031,0.186,1.519 C5.123,11.016,5.064,11,5,11c-2.209,0-4,1.791-4,4c0,1.202,0.541,2.267,1.38,3h18.593C22.196,17.089,23,15.643,23,14 C23,11.239,20.761,9,18,9z M12,16l-4-5h3V8h2v3h3L12,16z"})),j=r(530);var v=r(59);r(542);const C=e=>{const{getHeadersContent:t,getRowsContent:r,getSummary:a,isRequesting:c,primaryData:d,tableData:p,endpoint:b,itemIdField:v,tableQuery:C,compareBy:R,compareParam:w,searchBy:S,labels:D={},...E}=e,{query:q,columnPrefsKey:F}=e,{items:T,query:k}=p,x=q[w]?Object(g.getIdsFromQuery)(q[R]):[],[P,A]=Object(s.useState)(x),N=Object(s.useRef)(null),{updateUserPreferences:I,...Q}=Object(f.useUserPreferences)();if(p.isError||d.isError)return Object(s.createElement)(j.a,null);let B=[];F&&(B=Q&&Q[F]?Q[F]:B);const L=(e,n,s)=>{const o=a?a(n,s):null;return Object(i.applyFilters)("woocommerce_admin_report_table",{endpoint:b,headers:t(),rows:r(e),totals:n,summary:o,items:T})},V=t=>{const{ids:r}=e;A(t?r:[])},M=(t,r)=>{const{ids:a}=e;if(r)A(Object(m.uniq)([a[t],...P]));else{const e=P.indexOf(a[t]);A([...P.slice(0,e),...P.slice(e+1)])}},H=t=>{const{ids:r=[]}=e,a=-1!==P.indexOf(r[t]);return{display:Object(s.createElement)(o.CheckboxControl,{onChange:Object(m.partial)(M,t),checked:a}),value:!1}},Y=()=>{const{ids:t=[]}=e,r=t.length>0,a=r&&t.length===P.length;return{cellClassName:"is-checkbox-column",key:"compare",label:Object(s.createElement)(o.CheckboxControl,{onChange:V,"aria-label":Object(u.__)("Select All"),checked:a,disabled:!r}),required:!0}},U=c||p.isRequesting||d.isRequesting,G=Object(m.get)(d,["data","totals"],{}),$=T.totalResults||0,z=$>0,J=Object(g.getSearchWords)(q).map(e=>({key:e,label:e})),{data:K}=T,W=L(K,G,$);let{headers:X,rows:Z}=W;const{summary:ee}=W;R&&(Z=Z.map((e,t)=>[H(t),...e]),X=[Y(),...X]);const te=((e,t)=>t?e.map(e=>({...e,visible:e.required||!t.includes(e.key)})):e.map(e=>({...e,visible:e.required||!e.hiddenByDefault})))(X,B);return Object(s.createElement)(s.Fragment,null,Object(s.createElement)("div",{className:"woocommerce-report-table__scroll-point",ref:N,"aria-hidden":!0}),Object(s.createElement)(y.TableCard,n()({className:"woocommerce-report-table",hasSearch:!!S,actions:[R&&Object(s.createElement)(y.CompareButton,{key:"compare",className:"woocommerce-table__compare",count:P.length,helpText:D.helpText||Object(u.__)("Check at least two items below to compare","woocommerce-admin"),onClick:()=>{R&&Object(g.onQueryChange)("compare")(R,w,P.join(","))},disabled:!z},D.compareButton||Object(u.__)("Compare","woocommerce-admin")),S&&Object(s.createElement)(y.Search,{allowFreeTextSearch:!0,inlineTags:!0,key:"search",onChange:t=>{const{baseSearchQuery:r,addCesSurveyForCustomerSearch:a}=e,n=t.map(e=>e.label.replace(",","%2C"));n.length?(Object(g.updateQueryString)({filter:void 0,[w]:void 0,[S]:void 0,...r,search:Object(m.uniq)(n).join(",")}),a()):Object(g.updateQueryString)({search:void 0}),Object(_.recordEvent)("analytics_table_filter",{report:b})},placeholder:D.placeholder||Object(u.__)("Search by item name","woocommerce-admin"),selected:J,showClearButton:!0,type:S,disabled:!z}),z&&Object(s.createElement)(o.Button,{key:"download",className:"woocommerce-table__download-button",disabled:U,onClick:()=>{const{createNotice:t,startExport:r,title:a}=e,n=Object.assign({},q),{data:s,totalResults:o}=T;let i="browser";if(delete n.extended_info,n.search&&delete n[S],s&&s.length===o){const{headers:e,rows:t}=L(s,o);Object(h.downloadCSVFile)(Object(h.generateCSVFileName)(a,n),Object(h.generateCSVDataFromTable)(e,t))}else i="email",r(b,k).then(()=>t("success",Object(u.sprintf)(Object(u.__)("Your %s Report will be emailed to you.","woocommerce-admin"),a))).catch(e=>t("error",e.message||Object(u.sprintf)(Object(u.__)("There was a problem exporting your %s Report. Please try again.","woocommerce-admin"),a)));Object(_.recordEvent)("analytics_table_download",{report:b,rows:o,download_type:i})}},Object(s.createElement)(O,null),Object(s.createElement)("span",{className:"woocommerce-table__download-button__label"},D.downloadButton||Object(u.__)("Download","woocommerce-admin")))],headers:te,isLoading:U,onQueryChange:g.onQueryChange,onColumnsChange:(e,t)=>{const r=X.map(e=>e.key).filter(t=>!e.includes(t));if(F){I({[F]:r})}if(t){const r={report:b,column:t,status:e.includes(t)?"on":"off"};Object(_.recordEvent)("analytics_table_header_toggle",r)}},onSort:(e,t)=>{Object(g.onQueryChange)("sort")(e,t);const r={report:b,column:e,direction:t};Object(_.recordEvent)("analytics_table_sort",r)},onPageChange:(e,t)=>{N.current.scrollIntoView();const r=N.current.nextSibling.querySelector(".woocommerce-table__table"),a=l.focus.focusable.find(r);a.length&&a[0].focus(),t&&("goto"===t?Object(_.recordEvent)("analytics_table_go_to_page",{report:b,page:e}):Object(_.recordEvent)("analytics_table_page_click",{report:b,direction:t}))},rows:Z,rowsPerPage:parseInt(k.per_page,10)||f.QUERY_DEFAULTS.pageSize,summary:ee,totalRows:$},E)))};C.propTypes={baseSearchQuery:b.a.object,compareBy:b.a.string,compareParam:b.a.string,columnPrefsKey:b.a.string,endpoint:b.a.string,extendItemsMethodNames:b.a.shape({getError:b.a.string,isRequesting:b.a.string,load:b.a.string}),extendedItemsStoreName:b.a.string,getHeadersContent:b.a.func.isRequired,getRowsContent:b.a.func.isRequired,getSummary:b.a.func,itemIdField:b.a.string,labels:b.a.shape({compareButton:b.a.string,downloadButton:b.a.string,helpText:b.a.string,placeholder:b.a.string}),primaryData:b.a.object,searchBy:b.a.string,summaryFields:b.a.arrayOf(b.a.string),tableData:b.a.object.isRequired,tableQuery:b.a.object,title:b.a.string.isRequired},C.defaultProps={primaryData:{},tableData:{items:{data:[],totalResults:0},query:{}},tableQuery:{},compareParam:"filter",downloadable:!1,onSearch:m.noop,baseSearchQuery:{}};const R=[],w={};t.a=Object(c.compose)(Object(d.withSelect)((e,t)=>{const{endpoint:r,getSummary:a,isRequesting:n,itemIdField:s,query:o,tableData:i,tableQuery:c,filters:l,advancedFilters:d,summaryFields:u,extendedItemsStoreName:p}=t,b=e(f.REPORTS_STORE_NAME),y=p?e(p):null,{woocommerce_default_date_range:g}=e(f.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),h=o.search&&!(o[r]&&o[r].length);if(n||h)return w;const _="categories"===r?"products":r,O=a?Object(f.getReportChartData)({endpoint:_,selector:b,dataType:"primary",query:o,filters:l,advancedFilters:d,defaultDateRange:g,fields:u}):w,j=i||Object(f.getReportTableData)({endpoint:r,query:o,selector:b,tableQuery:c,filters:l,advancedFilters:d,defaultDateRange:g}),v=y?function(e,t,r){const{extendItemsMethodNames:a,itemIdField:n}=t,s=r.items.data;if(!(Array.isArray(s)&&s.length&&a&&n))return r;const{[a.getError]:o,[a.isRequesting]:i,[a.load]:c}=e,l={include:s.map(e=>e[n]).join(","),per_page:s.length},d=c(l),u=!!i&&i(l),p=!!o&&o(l),b=s.map(e=>{const t=Object(m.first)(d.filter(t=>e.id===t.id));return{...e,...t}}),y=r.isRequesting||u,g=r.isError||p;return{...r,isRequesting:y,isError:g,items:{...r.items,data:b}}}(y,t,j):j;return{primaryData:O,ids:s&&v.items.data?v.items.data.map(e=>e[s]):R,tableData:v,query:o}}),Object(d.withDispatch)(e=>{const{startExport:t}=e(f.EXPORT_STORE_NAME),{createNotice:r}=e("core/notices"),{addCesSurveyForCustomerSearch:a}=e(v.c);return{createNotice:r,startExport:t,addCesSurveyForCustomerSearch:a}}))(C)},534:function(e,t,r){"use strict";var a=r(0),n=r(2),s=r(14),o=r(65),i=r(8),c=r(5),l=r(1),d=r.n(l),m=r(22),u=r(12),p=r(21),b=r(527),y=r(530),g=r(13);function h(e){return t=>Object(o.format)(e,t)}class f extends a.Component{shouldComponentUpdate(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!Object(c.isEqual)(e.query,this.props.query)}getItemChartData(){const{primaryData:e,selectedChart:t}=this.props;return e.data.intervals.map((function(e){const r={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){const a=r[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;r[e.segment_id]={label:a,value:e.subtotals[t.key]||0}}})),{date:Object(o.format)("Y-m-d\\TH:i:s",e.date_start),...r}}))}getTimeChartData(){const{query:e,primaryData:t,secondaryData:r,selectedChart:a,defaultDateRange:n}=this.props,s=Object(p.getIntervalForQuery)(e,n),{primary:i,secondary:c}=Object(p.getCurrentDates)(e,n);return t.data.intervals.map((function(t,n){const l=Object(p.getPreviousDate)(t.date_start,i.after,c.after,e.compare,s),d=r.data.intervals[n];return{date:Object(o.format)("Y-m-d\\TH:i:s",t.date_start),primary:{label:`${i.label} (${i.range})`,labelDate:t.date_start,value:t.subtotals[a.key]||0},secondary:{label:`${c.label} (${c.range})`,labelDate:l.format("YYYY-MM-DD HH:mm:ss"),value:d&&d.subtotals[a.key]||0}}}))}getTimeChartTotals(){const{primaryData:e,secondaryData:t,selectedChart:r}=this.props;return{primary:Object(c.get)(e,["data","totals",r.key],null),secondary:Object(c.get)(t,["data","totals",r.key],null)}}renderChart(e,t,r,s){const{emptySearchResults:o,filterParam:i,interactiveLegend:c,itemsLabel:l,legendPosition:d,path:b,query:y,selectedChart:g,showHeaderControls:f,primaryData:_,defaultDateRange:O}=this.props,j=Object(p.getIntervalForQuery)(y,O),v=Object(p.getAllowedIntervalsForQuery)(y,O),C=Object(p.getDateFormatsForInterval)(j,_.data.intervals.length,{type:"php"}),R=o?Object(n.__)("No data for the current search","woocommerce-admin"):Object(n.__)("No data for the selected date range","woocommerce-admin"),{formatAmount:w,getCurrencyConfig:S}=this.context;return Object(a.createElement)(m.Chart,{allowedIntervals:v,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:R,filterParam:i,interactiveLegend:c,interval:j,isRequesting:t,itemsLabel:l,legendPosition:d,legendTotals:s,mode:e,path:b,query:y,screenReaderFormat:h(C.screenReaderFormat),showHeaderControls:f,title:g.label,tooltipLabelFormat:h(C.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&g.label||null,tooltipValueFormat:Object(u.getTooltipValueFormat)(g.type,w),chartType:Object(p.getChartTypeForQuery)(y),valueType:g.type,xFormat:h(C.xFormat),x2Format:h(C.x2Format),currency:S()})}renderItemComparison(){const{isRequesting:e,primaryData:t}=this.props;if(t.isError)return Object(a.createElement)(y.a,null);const r=e||t.isRequesting,n=this.getItemChartData();return this.renderChart("item-comparison",r,n)}renderTimeComparison(){const{isRequesting:e,primaryData:t,secondaryData:r}=this.props;if(!t||t.isError||r.isError)return Object(a.createElement)(y.a,null);const n=e||t.isRequesting||r.isRequesting,s=this.getTimeChartData(),o=this.getTimeChartTotals();return this.renderChart("time-comparison",n,s,o)}render(){const{mode:e}=this.props;return"item-comparison"===e?this.renderItemComparison():this.renderTimeComparison()}}f.contextType=b.a,f.propTypes={filters:d.a.array,isRequesting:d.a.bool,itemsLabel:d.a.string,limitProperties:d.a.array,mode:d.a.string,path:d.a.string.isRequired,primaryData:d.a.object,query:d.a.object.isRequired,secondaryData:d.a.object,selectedChart:d.a.shape({key:d.a.string.isRequired,label:d.a.string.isRequired,order:d.a.oneOf(["asc","desc"]),orderby:d.a.string,type:d.a.oneOf(["average","number","currency"]).isRequired}).isRequired},f.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};t.a=Object(s.compose)(Object(i.withSelect)((e,t)=>{const{charts:r,endpoint:a,filters:n,isRequesting:s,limitProperties:o,query:i,advancedFilters:l}=t,d=o||[a],m=function e(t,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||0===t.length)return null;const n=t.slice(0),s=n.pop();if(s.showFilters(r,a)){const e=Object(g.flattenFilters)(s.filters),t=r[s.param]||s.defaultValue||"all";return Object(c.find)(e,{value:t})}return e(n,r,a)}(n,i),p=Object(c.get)(m,["settings","param"]),b=t.mode||function(e,t){if(e&&t){const r=Object(c.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return Object(c.get)(e,["chartMode"])}return null}(m,i)||"time-comparison",{woocommerce_default_date_range:y}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),h=e(u.REPORTS_STORE_NAME),f={mode:b,filterParam:p,defaultDateRange:y};if(s)return f;const _=d.some(e=>i[e]&&i[e].length);if(i.search&&!_)return{...f,emptySearchResults:!0};const O=r&&r.map(e=>e.key),j=Object(u.getReportChartData)({endpoint:a,dataType:"primary",query:i,selector:h,limitBy:d,filters:n,advancedFilters:l,defaultDateRange:y,fields:O});if("item-comparison"===b)return{...f,primaryData:j};const v=Object(u.getReportChartData)({endpoint:a,dataType:"secondary",query:i,selector:h,limitBy:d,filters:n,advancedFilters:l,defaultDateRange:y,fields:O});return{...f,primaryData:j,secondaryData:v}}))(f)},536:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(5);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=Object(a.find)(t,{key:e});return r||t[0]}},537:function(e,t,r){"use strict";var a=r(0),n=r(2),s=r(14),o=r(8),i=r(1),c=r.n(i),l=r(13),d=r(22),m=r(122),u=r(12),p=r(21),b=r(17),y=r(530),g=r(527);class h extends a.Component{formatVal(e,t){const{formatAmount:r,getCurrencyConfig:a}=this.context;return"currency"===t?r(e):Object(m.formatValue)(a(),t,e)}getValues(e,t){const{emptySearchResults:r,summaryData:a}=this.props,{totals:n}=a,s=n.primary?n.primary[e]:0,o=n.secondary?n.secondary[e]:0,i=r?0:s,c=r?0:o;return{delta:Object(m.calculateDelta)(i,c),prevValue:this.formatVal(c,t),value:this.formatVal(i,t)}}render(){const{charts:e,query:t,selectedChart:r,summaryData:s,endpoint:o,report:i,defaultDateRange:c}=this.props,{isError:m,isRequesting:u}=s;if(m)return Object(a.createElement)(y.a,null);if(u)return Object(a.createElement)(d.SummaryListPlaceholder,{numberOfItems:e.length});const{compare:g}=Object(p.getDateParamsFromQuery)(t,c);return Object(a.createElement)(d.SummaryList,null,t=>{let{onToggle:s}=t;return e.map(e=>{const{key:t,order:c,orderby:m,label:u,type:p,isReverseTrend:y,labelTooltipText:h}=e,f={chart:t};m&&(f.orderby=m),c&&(f.order=c);const _=Object(l.getNewPath)(f),O=r.key===t,{delta:j,prevValue:v,value:C}=this.getValues(t,p);return Object(a.createElement)(d.SummaryNumber,{key:t,delta:j,href:_,label:u,reverseTrend:y,prevLabel:"previous_period"===g?Object(n.__)("Previous period:","woocommerce-admin"):Object(n.__)("Previous year:","woocommerce-admin"),prevValue:v,selected:O,value:C,labelTooltipText:h,onLinkClickCallback:()=>{s&&s(),Object(b.recordEvent)("analytics_chart_tab_click",{report:i||o,key:t})}})})})}}h.propTypes={charts:c.a.array.isRequired,endpoint:c.a.string.isRequired,limitProperties:c.a.array,query:c.a.object.isRequired,selectedChart:c.a.shape({key:c.a.string.isRequired,label:c.a.string.isRequired,order:c.a.oneOf(["asc","desc"]),orderby:c.a.string,type:c.a.oneOf(["average","number","currency"]).isRequired}).isRequired,summaryData:c.a.object,report:c.a.string},h.defaultProps={summaryData:{totals:{primary:{},secondary:{}},isError:!1}},h.contextType=g.a,t.a=Object(s.compose)(Object(o.withSelect)((e,t)=>{const{charts:r,endpoint:a,limitProperties:n,query:s,filters:o,advancedFilters:i}=t,c=n||[a],l=c.some(e=>s[e]&&s[e].length);if(s.search&&!l)return{emptySearchResults:!0};const d=r&&r.map(e=>e.key),{woocommerce_default_date_range:m}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{summaryData:Object(u.getSummaryNumbers)({endpoint:a,query:s,select:e,limitBy:c,filters:o,advancedFilters:i,defaultDateRange:m,fields:d}),defaultDateRange:m}}))(h)},542:function(e,t,r){}}]);