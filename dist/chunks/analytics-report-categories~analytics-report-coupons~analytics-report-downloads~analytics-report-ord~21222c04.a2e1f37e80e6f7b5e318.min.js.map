{"version":3,"sources":["webpack://wc.[modulename]/./client/analytics/components/report-chart/index.js","webpack://wc.[modulename]/./client/analytics/components/report-chart/utils.js"],"names":["ReportChart","nextProps","isRequesting","props","primaryData","secondaryData","isEqual","query","selectedChart","chartData","data","intervals","map","interval","intervalData","subtotals","segments","forEach","segment","segment_label","label","segment_id","value","key","date","formatDate","date_start","defaultDateRange","currentInterval","getIntervalForQuery","getCurrentDates","primary","secondary","index","secondaryDate","getPreviousDate","after","compare","secondaryInterval","range","labelDate","format","get","mode","legendTotals","emptySearchResults","filterParam","interactiveLegend","itemsLabel","legendPosition","path","showHeaderControls","allowedIntervals","getAllowedIntervalsForQuery","formats","getDateFormatsForInterval","length","emptyMessage","__","context","formatAmount","getCurrencyConfig","screenReaderFormat","tooltipLabelFormat","getTooltipValueFormat","type","getChartTypeForQuery","xFormat","x2Format","isError","isChartRequesting","getItemChartData","renderChart","getTimeChartData","getTimeChartTotals","renderItemComparison","renderTimeComparison","Component","contextType","CurrencyContext","propTypes","filters","PropTypes","array","bool","string","limitProperties","isRequired","object","shape","order","oneOf","orderby","defaultProps","compose","withSelect","select","charts","endpoint","advancedFilters","limitBy","selectedFilter","getSelectedFilter","chartMode","getChartMode","SETTINGS_STORE_NAME","getSetting","woocommerce_default_date_range","newProps","hasLimitByParam","some","item","search","fields","chart","getReportChartData","dataType","DEFAULT_FILTER","selectedFilterArgs","clonedFilters","slice","filterConfig","pop","showFilters","allFilters","flattenFilters","param","defaultValue","find","selectedFilterParam","Object","keys","includes"],"mappings":"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","file":"chunks/analytics-report-categories~analytics-report-coupons~analytics-report-downloads~analytics-report-ord~21222c04.a2e1f37e80e6f7b5e318.min.js","sourcesContent":["/**\n * External dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { format as formatDate } from '@wordpress/date';\nimport { get, isEqual } from 'lodash';\nimport PropTypes from 'prop-types';\n\n/**\n * WooCommerce dependencies\n */\nimport {\n\tgetAllowedIntervalsForQuery,\n\tgetCurrentDates,\n\tgetDateFormatsForInterval,\n\tgetIntervalForQuery,\n\tgetChartTypeForQuery,\n\tgetPreviousDate,\n} from 'lib/date';\nimport { Chart } from '@woocommerce/components';\nimport { SETTINGS_STORE_NAME } from '@woocommerce/data';\nimport { CurrencyContext } from 'lib/currency-context';\n\n/**\n * Internal dependencies\n */\nimport {\n\tgetReportChartData,\n\tgetTooltipValueFormat,\n} from 'wc-api/reports/utils';\nimport ReportError from 'analytics/components/report-error';\nimport withSelect from 'wc-api/with-select';\nimport { getChartMode, getSelectedFilter } from './utils';\n\n/**\n * Component that renders the chart in reports.\n */\nexport class ReportChart extends Component {\n\tshouldComponentUpdate( nextProps ) {\n\t\tif (\n\t\t\tnextProps.isRequesting !== this.props.isRequesting ||\n\t\t\tnextProps.primaryData.isRequesting !==\n\t\t\t\tthis.props.primaryData.isRequesting ||\n\t\t\tnextProps.secondaryData.isRequesting !==\n\t\t\t\tthis.props.secondaryData.isRequesting ||\n\t\t\t! isEqual( nextProps.query, this.props.query )\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetItemChartData() {\n\t\tconst { primaryData, selectedChart } = this.props;\n\t\tconst chartData = primaryData.data.intervals.map( function (\n\t\t\tinterval\n\t\t) {\n\t\t\tconst intervalData = {};\n\t\t\tinterval.subtotals.segments.forEach( function ( segment ) {\n\t\t\t\tif ( segment.segment_label ) {\n\t\t\t\t\tconst label = intervalData[ segment.segment_label ]\n\t\t\t\t\t\t? segment.segment_label +\n\t\t\t\t\t\t  ' (#' +\n\t\t\t\t\t\t  segment.segment_id +\n\t\t\t\t\t\t  ')'\n\t\t\t\t\t\t: segment.segment_label;\n\t\t\t\t\tintervalData[ segment.segment_id ] = {\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tvalue: segment.subtotals[ selectedChart.key ] || 0,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn {\n\t\t\t\tdate: formatDate( 'Y-m-d\\\\TH:i:s', interval.date_start ),\n\t\t\t\t...intervalData,\n\t\t\t};\n\t\t} );\n\t\treturn chartData;\n\t}\n\n\tgetTimeChartData() {\n\t\tconst {\n\t\t\tquery,\n\t\t\tprimaryData,\n\t\t\tsecondaryData,\n\t\t\tselectedChart,\n\t\t\tdefaultDateRange,\n\t\t} = this.props;\n\t\tconst currentInterval = getIntervalForQuery( query );\n\t\tconst { primary, secondary } = getCurrentDates(\n\t\t\tquery,\n\t\t\tdefaultDateRange\n\t\t);\n\n\t\tconst chartData = primaryData.data.intervals.map( function (\n\t\t\tinterval,\n\t\t\tindex\n\t\t) {\n\t\t\tconst secondaryDate = getPreviousDate(\n\t\t\t\tinterval.date_start,\n\t\t\t\tprimary.after,\n\t\t\t\tsecondary.after,\n\t\t\t\tquery.compare,\n\t\t\t\tcurrentInterval\n\t\t\t);\n\n\t\t\tconst secondaryInterval = secondaryData.data.intervals[ index ];\n\t\t\treturn {\n\t\t\t\tdate: formatDate( 'Y-m-d\\\\TH:i:s', interval.date_start ),\n\t\t\t\tprimary: {\n\t\t\t\t\tlabel: `${ primary.label } (${ primary.range })`,\n\t\t\t\t\tlabelDate: interval.date_start,\n\t\t\t\t\tvalue: interval.subtotals[ selectedChart.key ] || 0,\n\t\t\t\t},\n\t\t\t\tsecondary: {\n\t\t\t\t\tlabel: `${ secondary.label } (${ secondary.range })`,\n\t\t\t\t\tlabelDate: secondaryDate.format( 'YYYY-MM-DD HH:mm:ss' ),\n\t\t\t\t\tvalue:\n\t\t\t\t\t\t( secondaryInterval &&\n\t\t\t\t\t\t\tsecondaryInterval.subtotals[\n\t\t\t\t\t\t\t\tselectedChart.key\n\t\t\t\t\t\t\t] ) ||\n\t\t\t\t\t\t0,\n\t\t\t\t},\n\t\t\t};\n\t\t} );\n\n\t\treturn chartData;\n\t}\n\n\tgetTimeChartTotals() {\n\t\tconst { primaryData, secondaryData, selectedChart } = this.props;\n\n\t\treturn {\n\t\t\tprimary: get(\n\t\t\t\tprimaryData,\n\t\t\t\t[ 'data', 'totals', selectedChart.key ],\n\t\t\t\tnull\n\t\t\t),\n\t\t\tsecondary: get(\n\t\t\t\tsecondaryData,\n\t\t\t\t[ 'data', 'totals', selectedChart.key ],\n\t\t\t\tnull\n\t\t\t),\n\t\t};\n\t}\n\n\trenderChart( mode, isRequesting, chartData, legendTotals ) {\n\t\tconst {\n\t\t\temptySearchResults,\n\t\t\tfilterParam,\n\t\t\tinteractiveLegend,\n\t\t\titemsLabel,\n\t\t\tlegendPosition,\n\t\t\tpath,\n\t\t\tquery,\n\t\t\tselectedChart,\n\t\t\tshowHeaderControls,\n\t\t\tprimaryData,\n\t\t} = this.props;\n\t\tconst currentInterval = getIntervalForQuery( query );\n\t\tconst allowedIntervals = getAllowedIntervalsForQuery( query );\n\t\tconst formats = getDateFormatsForInterval(\n\t\t\tcurrentInterval,\n\t\t\tprimaryData.data.intervals.length\n\t\t);\n\t\tconst emptyMessage = emptySearchResults\n\t\t\t? __( 'No data for the current search', 'woocommerce-admin' )\n\t\t\t: __( 'No data for the selected date range', 'woocommerce-admin' );\n\t\tconst { formatAmount, getCurrencyConfig } = this.context;\n\t\treturn (\n\t\t\t<Chart\n\t\t\t\tallowedIntervals={ allowedIntervals }\n\t\t\t\tdata={ chartData }\n\t\t\t\tdateParser={ '%Y-%m-%dT%H:%M:%S' }\n\t\t\t\temptyMessage={ emptyMessage }\n\t\t\t\tfilterParam={ filterParam }\n\t\t\t\tinteractiveLegend={ interactiveLegend }\n\t\t\t\tinterval={ currentInterval }\n\t\t\t\tisRequesting={ isRequesting }\n\t\t\t\titemsLabel={ itemsLabel }\n\t\t\t\tlegendPosition={ legendPosition }\n\t\t\t\tlegendTotals={ legendTotals }\n\t\t\t\tmode={ mode }\n\t\t\t\tpath={ path }\n\t\t\t\tquery={ query }\n\t\t\t\tscreenReaderFormat={ formats.screenReaderFormat }\n\t\t\t\tshowHeaderControls={ showHeaderControls }\n\t\t\t\ttitle={ selectedChart.label }\n\t\t\t\ttooltipLabelFormat={ formats.tooltipLabelFormat }\n\t\t\t\ttooltipTitle={\n\t\t\t\t\t( mode === 'time-comparison' && selectedChart.label ) ||\n\t\t\t\t\tnull\n\t\t\t\t}\n\t\t\t\ttooltipValueFormat={ getTooltipValueFormat(\n\t\t\t\t\tselectedChart.type,\n\t\t\t\t\tformatAmount\n\t\t\t\t) }\n\t\t\t\tchartType={ getChartTypeForQuery( query ) }\n\t\t\t\tvalueType={ selectedChart.type }\n\t\t\t\txFormat={ formats.xFormat }\n\t\t\t\tx2Format={ formats.x2Format }\n\t\t\t\tcurrency={ getCurrencyConfig() }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderItemComparison() {\n\t\tconst { isRequesting, primaryData } = this.props;\n\n\t\tif ( primaryData.isError ) {\n\t\t\treturn <ReportError isError />;\n\t\t}\n\n\t\tconst isChartRequesting = isRequesting || primaryData.isRequesting;\n\t\tconst chartData = this.getItemChartData();\n\n\t\treturn this.renderChart(\n\t\t\t'item-comparison',\n\t\t\tisChartRequesting,\n\t\t\tchartData\n\t\t);\n\t}\n\n\trenderTimeComparison() {\n\t\tconst { isRequesting, primaryData, secondaryData } = this.props;\n\n\t\tif ( ! primaryData || primaryData.isError || secondaryData.isError ) {\n\t\t\treturn <ReportError isError />;\n\t\t}\n\n\t\tconst isChartRequesting =\n\t\t\tisRequesting ||\n\t\t\tprimaryData.isRequesting ||\n\t\t\tsecondaryData.isRequesting;\n\t\tconst chartData = this.getTimeChartData();\n\t\tconst legendTotals = this.getTimeChartTotals();\n\n\t\treturn this.renderChart(\n\t\t\t'time-comparison',\n\t\t\tisChartRequesting,\n\t\t\tchartData,\n\t\t\tlegendTotals\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { mode } = this.props;\n\t\tif ( mode === 'item-comparison' ) {\n\t\t\treturn this.renderItemComparison();\n\t\t}\n\t\treturn this.renderTimeComparison();\n\t}\n}\n\nReportChart.contextType = CurrencyContext;\n\nReportChart.propTypes = {\n\t/**\n\t * Filters available for that report.\n\t */\n\tfilters: PropTypes.array,\n\t/**\n\t * Whether there is an API call running.\n\t */\n\tisRequesting: PropTypes.bool,\n\t/**\n\t * Label describing the legend items.\n\t */\n\titemsLabel: PropTypes.string,\n\t/**\n\t * Allows specifying properties different from the `endpoint` that will be used\n\t * to limit the items when there is an active search.\n\t */\n\tlimitProperties: PropTypes.array,\n\t/**\n\t * `items-comparison` (default) or `time-comparison`, this is used to generate correct\n\t * ARIA properties.\n\t */\n\tmode: PropTypes.string,\n\t/**\n\t * Current path\n\t */\n\tpath: PropTypes.string.isRequired,\n\t/**\n\t * Primary data to display in the chart.\n\t */\n\tprimaryData: PropTypes.object,\n\t/**\n\t * The query string represented in object form.\n\t */\n\tquery: PropTypes.object.isRequired,\n\t/**\n\t * Secondary data to display in the chart.\n\t */\n\tsecondaryData: PropTypes.object,\n\t/**\n\t * Properties of the selected chart.\n\t */\n\tselectedChart: PropTypes.shape( {\n\t\t/**\n\t\t * Key of the selected chart.\n\t\t */\n\t\tkey: PropTypes.string.isRequired,\n\t\t/**\n\t\t * Chart label.\n\t\t */\n\t\tlabel: PropTypes.string.isRequired,\n\t\t/**\n\t\t * Order query argument.\n\t\t */\n\t\torder: PropTypes.oneOf( [ 'asc', 'desc' ] ),\n\t\t/**\n\t\t * Order by query argument.\n\t\t */\n\t\torderby: PropTypes.string,\n\t\t/**\n\t\t * Number type for formatting.\n\t\t */\n\t\ttype: PropTypes.oneOf( [ 'average', 'number', 'currency' ] ).isRequired,\n\t} ).isRequired,\n};\n\nReportChart.defaultProps = {\n\tisRequesting: false,\n\tprimaryData: {\n\t\tdata: {\n\t\t\tintervals: [],\n\t\t},\n\t\tisError: false,\n\t\tisRequesting: false,\n\t},\n\tsecondaryData: {\n\t\tdata: {\n\t\t\tintervals: [],\n\t\t},\n\t\tisError: false,\n\t\tisRequesting: false,\n\t},\n};\n\nexport default compose(\n\twithSelect( ( select, props ) => {\n\t\tconst {\n\t\t\tcharts,\n\t\t\tendpoint,\n\t\t\tfilters,\n\t\t\tisRequesting,\n\t\t\tlimitProperties,\n\t\t\tquery,\n\t\t\tadvancedFilters,\n\t\t} = props;\n\t\tconst limitBy = limitProperties || [ endpoint ];\n\t\tconst selectedFilter = getSelectedFilter( filters, query );\n\t\tconst filterParam = get( selectedFilter, [ 'settings', 'param' ] );\n\t\tconst chartMode =\n\t\t\tprops.mode ||\n\t\t\tgetChartMode( selectedFilter, query ) ||\n\t\t\t'time-comparison';\n\t\tconst { woocommerce_default_date_range: defaultDateRange } = select(\n\t\t\tSETTINGS_STORE_NAME\n\t\t).getSetting( 'wc_admin', 'wcAdminSettings' );\n\n\t\tconst newProps = {\n\t\t\tmode: chartMode,\n\t\t\tfilterParam,\n\t\t\tdefaultDateRange,\n\t\t};\n\n\t\tif ( isRequesting ) {\n\t\t\treturn newProps;\n\t\t}\n\n\t\tconst hasLimitByParam = limitBy.some(\n\t\t\t( item ) => query[ item ] && query[ item ].length\n\t\t);\n\n\t\tif ( query.search && ! hasLimitByParam ) {\n\t\t\treturn {\n\t\t\t\t...newProps,\n\t\t\t\temptySearchResults: true,\n\t\t\t};\n\t\t}\n\n\t\tconst fields = charts && charts.map( ( chart ) => chart.key );\n\n\t\tconst primaryData = getReportChartData( {\n\t\t\tendpoint,\n\t\t\tdataType: 'primary',\n\t\t\tquery,\n\t\t\tselect,\n\t\t\tlimitBy,\n\t\t\tfilters,\n\t\t\tadvancedFilters,\n\t\t\tdefaultDateRange,\n\t\t\tfields,\n\t\t} );\n\n\t\tif ( chartMode === 'item-comparison' ) {\n\t\t\treturn {\n\t\t\t\t...newProps,\n\t\t\t\tprimaryData,\n\t\t\t};\n\t\t}\n\n\t\tconst secondaryData = getReportChartData( {\n\t\t\tendpoint,\n\t\t\tdataType: 'secondary',\n\t\t\tquery,\n\t\t\tselect,\n\t\t\tlimitBy,\n\t\t\tfilters,\n\t\t\tadvancedFilters,\n\t\t\tdefaultDateRange,\n\t\t\tfields,\n\t\t} );\n\t\treturn {\n\t\t\t...newProps,\n\t\t\tprimaryData,\n\t\t\tsecondaryData,\n\t\t};\n\t} )\n)( ReportChart );\n","/**\n * External dependencies\n */\nimport { find, get } from 'lodash';\n\n/**\n * WooCommerce dependencies\n */\nimport { flattenFilters } from '@woocommerce/navigation';\n\nexport const DEFAULT_FILTER = 'all';\n\nexport function getSelectedFilter( filters, query, selectedFilterArgs = {} ) {\n\tif ( ! filters || filters.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tconst clonedFilters = filters.slice( 0 );\n\tconst filterConfig = clonedFilters.pop();\n\n\tif ( filterConfig.showFilters( query, selectedFilterArgs ) ) {\n\t\tconst allFilters = flattenFilters( filterConfig.filters );\n\t\tconst value =\n\t\t\tquery[ filterConfig.param ] ||\n\t\t\tfilterConfig.defaultValue ||\n\t\t\tDEFAULT_FILTER;\n\t\treturn find( allFilters, { value } );\n\t}\n\n\treturn getSelectedFilter( clonedFilters, query, selectedFilterArgs );\n}\n\nexport function getChartMode( selectedFilter, query ) {\n\tif ( selectedFilter && query ) {\n\t\tconst selectedFilterParam = get( selectedFilter, [\n\t\t\t'settings',\n\t\t\t'param',\n\t\t] );\n\n\t\tif (\n\t\t\t! selectedFilterParam ||\n\t\t\tObject.keys( query ).includes( selectedFilterParam )\n\t\t) {\n\t\t\treturn get( selectedFilter, [ 'chartMode' ] );\n\t\t}\n\t}\n\n\treturn null;\n}\n"],"sourceRoot":""}